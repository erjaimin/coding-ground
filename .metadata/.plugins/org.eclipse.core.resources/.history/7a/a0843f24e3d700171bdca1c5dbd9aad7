package com.mvc.controller;

import java.awt.Component;
import java.io.File;

import com.main.PatternObjectFactroy;
import com.mvc.model.ImageModel;
import com.mvc.model.PerspectiveModel;
import com.mvc.view.MainFrame;

public class ModelViewController {
	private MainFrame view;
	private ImageModel imgModel;
	private PerspectiveModel topPerspectiveModel;
	private PerspectiveModel bottomPerspectiveModel;

	public ModelViewController(MainFrame view, ImageModel imgModel, PerspectiveModel topPerspectiveModel,
			PerspectiveModel bottomPerspectiveModel) {
		this.view = view;
		this.imgModel = imgModel;
		this.topPerspectiveModel = topPerspectiveModel;
		this.bottomPerspectiveModel = bottomPerspectiveModel;
		setUpListeners();
	}

	private void setUpListeners() {
		view.getOpen().addActionListener(e -> {
			view.openFileDialog();
			File selectedFile = view.getFileChooser().getSelectedFile();
			imgModel.setInputFile(selectedFile);
			topPerspectiveModel.setInputFile(inputFile);
		});

		view.getQuit().addActionListener(e -> System.exit(0));

		Component topPanel = view.getPerspectivePlane().getLeftComponent();
		topPanel.addMouseWheelListener(e -> {
			int notches = e.getWheelRotation();
			ZoomCommand zCommand = PatternObjectFactroy.getActionCommand(topPerspectiveModel, notches);
			double temp = zoom - (notches * 0.2);
			// minimum zoom factor is 1.0
			temp = Math.max(temp, 1.0);
			if (temp != zoom) {
				zoom = temp;
				resizeImage();
			}

		});

	}

}
