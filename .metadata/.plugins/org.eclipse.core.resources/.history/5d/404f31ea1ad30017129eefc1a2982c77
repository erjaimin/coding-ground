<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<%@page import="java.util.Map"%>
<%@page import="java.util.List"%>
<%@page import="java.util.ArrayList"%>
<%@page import="java.util.HashMap"%>
<%@ page import="java.sql.*"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix = "sql" uri = "http://java.sun.com/jsp/jstl/sql" %>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%! 
	public void jspInit() {
		System.out.println("Couldnâ€™t load inventory.");
}%>
<%!   String query1 = "SELECT CUSTOMER.CUSTOMER_ID, CUSTOMER.CUSTOMER_NAME "+ 
			    "FROM CUSTOMER INNER JOIN SALES_ORDER ON SALES_ORDER.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID "+
			    "GROUP BY CUSTOMER.CUSTOMER_ID, CUSTOMER.CUSTOMER_NAME";
	  String query2 = "SELECT SUM(SALES_ORDER_LINE_ITEM.QUANTITY) AS Quantity, "+ 
			    "BOM.OUTPUT_DESCRIPTION AS Product, SALES_ORDER.BILLING_DATE FROM SALES_ORDER_LINE_ITEM "+ 
			    "INNER JOIN sales_order ON SALES_ORDER_LINE_ITEM.SALES_ORDER_ID = SALES_ORDER.SALES_ORDER_ID "+ 
			    "INNER JOIN CUSTOMER ON CUSTOMER.CUSTOMER_ID = SALES_ORDER.CUSTOMER_ID "+
			    "INNER JOIN BOM ON BOM.EFFECTIVE_DATE = SALES_ORDER.DELIVERY_DATE "+ 
			    "AND BOM.OUTPUT_PRODUCT_ID = SALES_ORDER_LINE_ITEM.PRODUCT_ID "+ 
			    "WHERE CUSTOMER.CUSTOMER_ID = ? GROUP BY "+
			    "BOM.OUTPUT_DESCRIPTION, SALES_ORDER.BILLING_DATE";
	  String query3 ="SELECT SIM_DATE.SIM_DATE FROM CURRENT_SIM_DATE "+
			    "INNER JOIN SIM_DATE ON CURRENT_SIM_DATE.CUR_NB_DAYS> = SIM_DATE.NB_DAYS "+
			    "WHERE VDAY <= MAX_DAYS_PER_ROUND";
%>
<sql:setDataSource var="ERPSIM" driver="com.mysql.jdbc.Driver"
         url="jdbc:mysql://localhost:3306/ERPSIM"
         user="root"  password="system"/>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Sales Statistics</title>
	<style type="text/css">
		input{
		}
	</style>
	<c:set property="" value=""></c:set>
</head>
<body>
    <sql:query dataSource="${ERPSIM}" var="clients"><%=query1%></sql:query>
	<form>
		<div class="header">
	         Client :
	         <select id="customerDropDown" onchange="fetchClientDetails(this);">
	            <option value = "-1" selected>--Choose Client--</option>
	            <c:forEach items="${clients.rows}" var="client">
	            	<option value = "${client.CUSTOMER_ID}">${client.CUSTOMER_NAME}</option>
	            </c:forEach>
	         </select>
		     <input type="button" id="btnTable" value="Table" />
		     <input type="button" id="btnGraph" value="Graph" />
	    </div>  
	    <div>
	    	<table>
			  <tr>
			  	<th>Date</th>
			  	<th>Product</th>
			  	<th>Quantity</th>
			  </tr>
			 
			</table>
	    </div>   
     </form>
</body>
</html>